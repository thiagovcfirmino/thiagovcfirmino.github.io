import{R as b}from"./index.CC6F48bw.js";const H=r=>{let s;const t=new Set,o=(i,g)=>{const S=typeof i=="function"?i(s):i;if(!Object.is(S,s)){const v=s;s=g??(typeof S!="object"||S===null)?S:Object.assign({},s,S),t.forEach(m=>m(s,v))}},a=()=>s,u={setState:o,getState:a,getInitialState:()=>d,subscribe:i=>(t.add(i),()=>t.delete(i))},d=s=r(o,a,u);return u},R=(r=>r?H(r):H),j=r=>r;function k(r,s=j){const t=b.useSyncExternalStore(r.subscribe,b.useCallback(()=>s(r.getState()),[r,s]),b.useCallback(()=>s(r.getInitialState()),[r,s]));return b.useDebugValue(t),t}const w=r=>{const s=R(r),t=o=>k(s,o);return Object.assign(t,s),t},F=(r=>w);function E(r,s){let t;try{t=r()}catch{return}return{getItem:a=>{var n;const f=d=>d===null?null:JSON.parse(d,void 0),u=(n=t.getItem(a))!=null?n:null;return u instanceof Promise?u.then(f):f(u)},setItem:(a,n)=>t.setItem(a,JSON.stringify(n,void 0)),removeItem:a=>t.removeItem(a)}}const p=r=>s=>{try{const t=r(s);return t instanceof Promise?t:{then(o){return p(o)(t)},catch(o){return this}}}catch(t){return{then(o){return this},catch(o){return p(o)(t)}}}},x=(r,s)=>(t,o,a)=>{let n={storage:E(()=>localStorage),partialize:e=>e,version:0,merge:(e,h)=>({...h,...e}),...s},f=!1;const u=new Set,d=new Set;let i=n.storage;if(!i)return r((...e)=>{console.warn(`[zustand persist middleware] Unable to update item '${n.name}', the given storage is currently unavailable.`),t(...e)},o,a);const g=()=>{const e=n.partialize({...o()});return i.setItem(n.name,{state:e,version:n.version})},S=a.setState;a.setState=(e,h)=>(S(e,h),g());const v=r((...e)=>(t(...e),g()),o,a);a.getInitialState=()=>v;let m;const _=()=>{var e,h;if(!i)return;f=!1,u.forEach(c=>{var l;return c((l=o())!=null?l:v)});const y=((h=n.onRehydrateStorage)==null?void 0:h.call(n,(e=o())!=null?e:v))||void 0;return p(i.getItem.bind(i))(n.name).then(c=>{if(c)if(typeof c.version=="number"&&c.version!==n.version){if(n.migrate){const l=n.migrate(c.state,c.version);return l instanceof Promise?l.then(I=>[!0,I]):[!0,l]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,c.state];return[!1,void 0]}).then(c=>{var l;const[I,O]=c;if(m=n.merge(O,(l=o())!=null?l:v),t(m,!0),I)return g()}).then(()=>{y?.(m,void 0),m=o(),f=!0,d.forEach(c=>c(m))}).catch(c=>{y?.(void 0,c)})};return a.persist={setOptions:e=>{n={...n,...e},e.storage&&(i=e.storage)},clearStorage:()=>{i?.removeItem(n.name)},getOptions:()=>n,rehydrate:()=>_(),hasHydrated:()=>f,onHydrate:e=>(u.add(e),()=>{u.delete(e)}),onFinishHydration:e=>(d.add(e),()=>{d.delete(e)})},n.skipHydration||_(),m||v},J=x;export{F as c,J as p};
